<section>


	<div class=" row">
		<div class="col-md-12">
			<div class="">
				<div class="">
					<div class="px-3">


						<form class="form form-horizontal">
							<div class="form-body">

								<div class="card">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Datos de la empresa</h6>
										</div>
									</div>

									<div class="card-body p-3">
										<div class="col-md-12 ">
											<label for="pernombre">Nombre: </label>
											<input type="hidden" id="expreg" name="appreg" value="{expreg}">
											<input type="text" id="expnombre" name="expnombre" class="form-control"
												value="{expnombre}">
										</div>
										<div class="col-md-12 mt-3">
											<label for="pernombre">Categoria: </label>
											<select id="expcatego" name="expcatego" class="form-control">
												<option value="0">Seleccione...</option>
												<option value="Gold" {selected}>Gold</option>
												<option value="Silver" {selected}>Silver</option>
												<option value="Bronze" {selected}>Bronze</option>
											</select>
										</div>
									</div>
								</div>



								<div class="card">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Datos de contacto</h6>
										</div>
									</div>

									<div class="card-body p-2">
										<div class="col-md-12 mt-2">
											<label for="expdireccion mt-2 ">Direccion: </label>
											<input type="text" id="expdireccion" name="pertwi" class="form-control"
												value="{expdireccion}">
										</div>

										<div class="col-md-12">
											<label for="exptelefo mt-2">Telefono: </label>
											<input type="text" id="exptelefo" name="exptelefo" class="form-control"
												value="{exptelefo}">
										</div>
										<div class="col-md-12">
											<label for="pernombre mt-2">Mail: </label>
											<input type="text" id="expmail" name="expmail" class="form-control"
												value="{expmail}">
										</div>
										<div class="col-md-12 mt-2">
											<label class="" for="pernombre">Web: </label>
											<input type="text" id="expweb" name="expweb" class="form-control"
												value="{expweb}">
										</div>
										<div class="col-md-12 mt-2">
											<label for="pernombre">Linkedin: </label>
											<input type="text" id="explinked" name="explinked" class="form-control"
												value="{explinked}">
										</div>
										<div class="col-md-12 mt-2">
											<label class="" for="expfac">Facebook: </label>
											<input type="text" id="expfac" name="expfac" class="form-control"
												value="{expfac}">
										</div>
										<div class="col-md-12 mt-2">
											<label for="exptwi">Twitter: </label>
											<input type="text" id="exptwi" name="exptwi" class="form-control"
												value="{exptwi}">
										</div>
										<div class="col-md-12 mt-2 mb-3">
											<label for="expyoutub">Youtube: </label>
											<input type="text" id="expyoutub" name="expyoutub" class="form-control"
												value="{expyoutub}">
										</div>
										<div class="col-md-12 mt-2 mb-3">
											<label for="expyoutub">Foto de perfil: </label>
											<input type="file" id="expavatar" name="expavatar" class="form-control"
												value="{expavatar}">
										</div>
									</div>
								</div>




								<div class="card">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Sobre la empresa</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12 mb-3">
											<label for="pernombre">Sobre la empresa: </label>
											<textarea class="form-control" rows="8" id="exprubros" name="exprubros"
												class="form-control"> {exprubros} </textarea>
										</div>

									</div>

								</div>

								<!-- -------------------------- CUADROS DE TEXTO --------------------------- -->

								<div class="card">
									<div class="card-header " id="texto1">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Cuadro de texto 1 </h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12 mb-3">
											<label for="pernombre">Titulo: </label>
											<input value="{exptitulo1}" type="text" id="exptitulo1" name=""
												class="form-control mb-3" value="">
											<label for="pernombre">Contenido: </label>
											<textarea class="form-control" rows="8" id="exptxt1" name="exprubros"
												class="form-control"> {exptxt1} </textarea>
										</div>


									</div>

								</div>
								<div class="card" id="texto2">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Cuadro de texto 2 </h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12 mb-3">
											<label for="pernombre">Titulo: </label>
											<input value="{exptitulo2}" type="text" id="exptitulo2" name=""
												class="form-control mb-3" value="{exptitulo2}">
											<label for="pernombre">Contenido: </label>
											<textarea class="form-control" rows="8" id="exptxt2" name="exprubros"
												class="form-control">{exptxt2}</textarea>
										</div>


									</div>

								</div>
								<div class="card" id="texto3">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Cuadro de texto 3 </h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12 mb-3">
											<label for="pernombre">Titulo: </label>
											<input type="text" id="exptitulo3" value="{exptitulo3}" name=""
												class="form-control mb-3" value="">
											<label for="pernombre">Contenido: </label>
											<textarea class="form-control" rows="8" id="exptxt3" value="{exptxt3}"
												name="" class="form-control"> {exptxt3} </textarea>
										</div>


									</div>

								</div>


								<!-- ------------------------------- BANNERS ------------------------------- -->

								<div class="card">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Banners</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">

											<label for="exptelefo">Banner Perfil: </label>
											<input type="file" name="expbanimg1" id="expbanimg1">
											<label for="exptelefo">{expbanimg1}</label>

										</div>


										<div class="col-md-12 mt-3">

											<label for="exptelefo">Banner Listado: </label>
											<input type="file" name="expbanimg2" id="expbanimg2">
											<label for="exptelefo">{expbanimg2}</label>

										</div>


										<div class="col-md-12 mt-3">

											<label for="exptelefo">Banner Responsive: </label>
											<input type="file" name="expbanimg3" id="expbanimg3">

										</div>


									</div>

								</div>

								<!-- ------------------------------- VIDEOS -------------------------------- -->

								<div class="card" id="video1">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Video 1</h6>

										</div>
									</div>
									<div class="card-body p-2">
										<div class="col-md-12">
											<label for="exptelefo">Link Youtube: </label>
											<input type="text" id="expvid1" name="expvid1" class="form-control mb-3"
												value="{expvid1}">
										</div>
									</div>
								</div>
								<div class="card" id="video2">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Video 2</h6>

										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">
											<label for="exptelefo">Link Youtube: </label>
											<input type="text" id="expvid2" name="expvid2" class="form-control mb-3"
												value="{expvid2}">
										</div>
									</div>

								</div>
								<div class="card" id="video3">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Video 3</h6>

										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">

											<label for="exptelefo">Link Youtube: </label>
											<input type="text" id="expvid3" name="expvid3" class="form-control mb-3"
												value="{expvid3}">
										</div>
									</div>
								</div>


								<!-- ------------------------------ IMAGENES ------------------------------- -->

								<div class="card" id="imagen1">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Imagen 1</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">

											<label for="exptelefo">Imagen</label>
											<input type="file" name="expimg1" id="expimg1">

										</div>
									</div>

								</div>
								<div class="card" id="imagen2">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Imagen 2</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">

											<label for="exptelefo">Imagen</label>
											<input type="file" name="expimg2" id="expimg2">

										</div>
									</div>

								</div>
								<div class="card" id="imagen3">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Imagen 3</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">

											<label for="exptelefo">Imagen</label>
											<input type="file" name="expimg3" id="expimg3">

										</div>
									</div>

								</div>
								<div class="card">
									<div class="card-header">
										<div class="card-title-wrap bar-warning">
											<h6 class="card-title">Datos del evento</h6>
										</div>
									</div>

									<div class="card-body p-2">

										<div class="col-md-12">
											<label for="pernombre">Stand: </label>
											<input type="text" id="expstand" name="expstand" class="form-control"
												value="{expstand}">
										</div>
										<div class="col-md-3">
											<label for="pernombre">Posici&oacute;n Mapa X: </label>
											<input type="text" id="expposx" name="expposx" class="form-control"
												value="{expposx}">
										</div>


										<div class="col-md-3">
											<label for="pernombre">Posici&oacute;n Mapa Y:</label>


											<input type="text" id="expposy" name="expposy" class="form-control"
												value="{expposy}">
										</div>

										<div class="col-md-3">
											<label for="pernombre">Posicion: </label>
											<input type="text" id="orden" name="orden" class="form-control"
												value="{orden}">
										</div>
										<div class="col-md-12">
											<label for="paicodigo">Perfil Relacionado: </label>
											<select id="percodigo" name="percodigo" class="form-control">
												<option value="0" selected>{Idioma_Seleccione}...</option>
												<!-- BEGIN perfiles -->
												<option value="{percodigo}" {persel}>{percompan} - {pernombre}
													{perapelli}
												</option>
												<!-- END perfiles -->

											</select>
										</div>
									</div>

								</div>

							</div>
					</div>

				</div>
				<div class="form-actions">
					<button id="btnguardar" type="button" class="btn btn-success" onclick="guardarMaestroMsg();">
						<i class="icon-note"></i> Guardar
					</button>
					<button id="btncancelar" type="button" class="btn btn-danger mr-1" onclick="showBrowser();">
						<i class="icon-trash"></i> Cancelar
					</button>
					&nbsp;&nbsp;
				</div>
				</form>
			</div>
		</div>
	</div>
	</div>

</section>

<script>

	//extraer id del video
	function getId(url) {
		const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
		const match = url.match(regExp);

		return (match && match[2].length === 11)
			? match[2]
			: null;
	}

	//oculto o muestro los box segun categoria
	$('#expcatego').on('change', () => {
		switch ($('#expcatego').val()) {
			case 'Gold':
				$('#texto2').show()
				$('#imagen2').show();
				$('#video2').show();
				$('#texto3').show()
				$('#imagen3').show();
				$('#video3').show();
				break;
			case 'Silver':
				$('#texto2').show()
				$('#imagen2').show();
				$('#video2').show();
				$('#texto3').hide()
				$('#imagen3').hide();
				$('#video3').hide();
				break;
			case 'Bronze':
				$('#texto2').hide()
				$('#imagen2').hide();
				$('#video2').hide();
				$('#texto3').hide()
				$('#imagen3').hide();
				$('#video3').hide();
				break;
		}

	});



	function guardarMaestroMsg() {
		var errcod = 0;
		var errmsg = '';
		var expreg = $('#expreg').val();




		if (errcod == 0) {
			swal({
				title: "GUARDAR",
				text: "¿Confirma guardar los cambios?",
				type: 'question',
				showCancelButton: true,
				confirmButtonColor: '#0CC27E',
				cancelButtonColor: '#FF586B',
				confirmButtonText: 'Confirmar',
				cancelButtonText: 'Cancelar',
				confirmButtonClass: 'btn btn-success btn-raised mr-5',
				cancelButtonClass: 'btn btn-danger btn-raised',
				buttonsStyling: false
			}).then(function () {
				guardarMaestro();
			}, function (dismiss) {
				// dismiss can be 'overlay', 'cancel', 'close', 'esc', 'timer'
				if (dismiss === 'cancel') {
				}
			}).done();
		}
	}

	function guardarMaestro() {
		var formData = new FormData($('#FrmMst')[0]);
		formData.append("expreg", $('#expreg').val());
		formData.append("expnombre", $('#expnombre').val());
		formData.append("expweb", $('#expweb').val());
		formData.append("expmail", $('#expmail').val());
		formData.append("expstand", $('#expstand').val());
		formData.append("exprubros", $('#exprubros').val());
		formData.append("expposx", $('#expposx').val());
		formData.append("expposy", $('#expposy').val());
		formData.append("estcodigo", $('#estcodigo').val());
		formData.append("expcatego", $('#expcatego').val());
		formData.append("percodigo", $('#percodigo').val());
		formData.append("orden", $('#orden').val());

		//NUEVOS CAMPOS
		formData.append("explinked", $('#explinked').val());
		formData.append("expfac", $('#expfac').val());
		formData.append("exptwi", $('#exptwi').val());
		formData.append("expdireccion", $('#expdireccion').val());
		formData.append("exptelefo", $('#exptelefo').val());
		formData.append("expyoutub", $('#expyoutub').val());

		//cuadros de texto
		formData.append("exptitulo1", $('#exptitulo1').val());
		formData.append("exptitulo2", $('#exptitulo2').val());
		formData.append("exptitulo3", $('#exptitulo3').val());
		//
		formData.append("exptxt1", $('#exptxt1').val());
		formData.append("exptxt2", $('#exptxt2').val());
		formData.append("exptxt3", $('#exptxt3').val());
		//videos
		formData.append("expvid1", getId($('#expvid1').val()));
		formData.append("expvid2", getId($('#expvid1').val()));
		formData.append("expvid3", getId($('#expvid1').val()));
		//imagenes

		if (typeof ($('#expimg1')[0].files[0]) !== "undefined") {
			formData.append('expimg1', $('#expimg1')[0].files[0]);
		}

		if (typeof ($('#expimg2')[0].files[0]) !== "undefined") {
			formData.append('expimg2', $('#expimg2')[0].files[0]);
		}

		if (typeof ($('#expimg3')[0].files[0]) !== "undefined") {
			formData.append('expimg3', $('#expimg3')[0].files[0]);
		}
		//banners
		if (typeof ($('#expbanimg1')[0].files[0]) !== "undefined") {
			formData.append('expbanimg1', $('#expbanimg1')[0].files[0]);
		}
		if (typeof ($('#expbanimg2')[0].files[0]) !== "undefined") {
			formData.append('expbanimg2', $('#expbanimg2')[0].files[0]);
		}
		if (typeof ($('#expbanimg3')[0].files[0]) !== "undefined") {
			formData.append('expbanimg3', $('#expbanimg3')[0].files[0]);
		}


		//avatar

		if (typeof ($('#expavatar')[0].files[0]) !== "undefined") {
			formData.append('expavatar', $('#expavatar')[0].files[0]);
		}

		$.ajax({
			type: "POST",
			url: "grb.php",
			dataType: "html",
			data: formData,
			cache: false,
			contentType: false,
			processData: false
		}).done(function (rsp) {
			data = $.parseJSON(rsp);

			if (data.errcod == 0) {
				toastr.success(data.errmsg, 'GUARDAR');

				showBrowser();
			} else {
				toastr.error(data.errmsg, 'GUARDAR');

			}

		});
	}

	function point_it(event) {
		var x = event.clientX;
		var y = event.clientY;
		var coords = "X coords: " + x + ", Y coords: " + y;
		$('#expposx').val(x);
		$('#expposy').val(y);
	}

	function findAvatar() {
		$('#imgavatar').attr('src', '{imgAvatarNull}');
		$('#fileavatar').click();
	}

	function readURLAvatar(input) {
		if (input.files && input.files[0]) {
			var reader = new FileReader();
			var fname = null;

			reader.onload = function (e) {
				$('#imgavatar').attr('src', e.target.result);

				var image = new Image();
				image.src = e.target.result;
				image.onload = function () {
					//var height = 100;
					//var w = $('#imgview')[0].naturalWidth;
					//var h = $('#imgview')[0].naturalHeight;				
					//var newWidth = height * w / h;
					//$('#imgview').css('width',newWidth);
					//$('#imgview').css('height',height);
				};
			}

			reader.readAsDataURL(input.files[0]);
			//$('#uploadfile').hide();
			//$('#mnuimgurl').val(input.files[0].name);
		}
	}
</script>